(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28174,        736]
NotebookOptionsPosition[     26758,        707]
NotebookOutlinePosition[     27207,        724]
CellTagsIndexPosition[     27164,        721]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PDE", ":", 
     RowBox[{"u_t", "-", 
      RowBox[{"a", " ", "u_x"}]}]}], "=", "phi"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Eq", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
      RowBox[{"xi", ",", "tj"}], "]"}], "-", 
     RowBox[{"a", "*", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"xi", ",", "tj"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"hStep", "=", "hStep"}], ";"}], "      ", 
  RowBox[{"(*", 
   RowBox[{
   "\:043f\:0440\:043e\:0441\:0442\:0440\:0430\:043d\:0441\:0442\:0432\:0435\
\:043d\:043d\:044b\:0439", " ", "\:0448\:0430\:0433"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tauStep", "=", "tauStep"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "\:0432\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", 
    "\:0448\:0430\:0433"}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:0428\:0430\:0431\:043b\:043e\:043d", " ", 
    "\:0432\:0430\:0440\:0438\:0430\:043d\:0442\:0430", " ", "10"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sh", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"u", "[", 
        RowBox[{"i", ",", 
         RowBox[{"j", "-", "1"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"u", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"u", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "    ", 
     RowBox[{"(*", 
      RowBox[{"u", "[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "1"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:041a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\:044b",
     " ", 
    RowBox[{"(", 
     RowBox[{
     "\:043e\:0431\:044b\:0447\:043d\:044b\:0435", " ", 
      "\:0441\:0438\:043c\:0432\:043e\:043b\:044b"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}], "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<c\>\"", "<>", 
        RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", "4"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cs", "=", 
    RowBox[{"{", 
     RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0420\:0430\:0437\:043b\:043e\:0436\:0435\:043d\:0438\:0435", " ", 
     "\:0422\:0435\:0439\:043b\:043e\:0440\:0430", " ", "\:0434\:043e", " ", 
     "3"}], "-", 
    RowBox[{
    "\:0433\:043e", " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0430", " ", 
     "\:0441", " ", "\:0437\:0430\:0449\:0438\:0442\:043e\:0439", " ", 
     "\:043e\:0442", " ", 
     RowBox[{"0", "^", "0"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TSU", "[", 
     RowBox[{"{", 
      RowBox[{"dx_", ",", "dt_"}], "}"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "u", "]"}], "[", 
        RowBox[{"xi", ",", "tj"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"hStep", "*", "dx"}], ")"}], "^", "i"}]}], "]"}], ")"}], 
       "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "==", "0"}], ",", "1", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tauStep", "*", "dt"}], ")"}], "^", "j"}]}], "]"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "!"}], " ", 
          RowBox[{"j", "!"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:041b\:0438\:043d\:0435\:0439\:043d\:0430\:044f", " ", 
    "\:043a\:043e\:043c\:0431\:0438\:043d\:0430\:0446\:0438\:044f", " ", 
    "\:0443\:0437\:043b\:043e\:0432"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    RowBox[{"Cs", ".", 
     RowBox[{"(", 
      RowBox[{"TSU", "/@", "Sh"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\:041e\:0441\:0442\:0430\:0442\:043e\:043a", ":", 
     RowBox[{
     "L", " ", 
      "\:0430\:043f\:043f\:0440\:043e\:043a\:0441\:0438\:043c\:0438\:0440\
\:0443\:0435\:0442", " ", "Eq"}]}], ",", 
    RowBox[{
     RowBox[{"\:043f\:043e\:044d\:0442\:043e\:043c\:0443", " ", "R"}], "=", 
     RowBox[{"Eq", "-", "L"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{"Eq", "-", "L"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:041f\:0440\:043e\:0438\:0437\:0432\:043e\:0434\:043d\:044b\:0435", ",", 
    RowBox[{
    "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\:044b\
", " ", "\:043f\:0440\:0438", " ", 
     "\:043a\:043e\:0442\:043e\:0440\:044b\:0445", " ", "\:043c\:044b", " ", 
     "\:043f\:0440\:0438\:0440\:0430\:0432\:043d\:0438\:0432\:0430\:0435\:043c\
", " ", "\:043d\:0443\:043b\:044e"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toZero", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"xi", ",", "tj"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"xi", ",", "tj"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"xi", ",", "tj"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"xi", ",", "tj"}], "]"}]}], "}"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:0418\:0437\:0432\:043b\:0435\:043a\:0430\:0435\:043c", " ", 
    "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\:044b\
", " ", "\:043f\:0440\:0438", " ", "\:044d\:0442\:0438\:0445", " ", 
    "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:0434\:043d\:044b\:0445"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"R", ",", "#"}], "]"}], "&"}], "/@", "toZero"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0421\:0438\:0441\:0442\:0435\:043c\:0430", " ", 
     "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
     "coeffs"}], "==", "0"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eqns", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{"coeffs", "==", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0414\:043e\:043f\:043e\:043b\:043d\:0438\:0442\:0435\:043b\:044c\:043d\
\:043e\:0435", " ", 
     RowBox[{"\:0443\:0441\:043b\:043e\:0432\:0438\:0435", ":", 
      RowBox[{
       RowBox[{
       "\:0444\:0438\:043a\:0441\:0438\:0440\:0443\:0435\:043c", " ", "c3"}], 
       "==", "0"}]}]}], ",", 
    RowBox[{
    "\:0447\:0442\:043e\:0431\:044b", " ", 
     "\:043f\:043e\:043b\:0443\:0447\:0438\:0442\:044c", " ", 
     "\:0435\:0434\:0438\:043d\:0441\:0442\:0432\:0435\:043d\:043d\:043e\:0435\
", " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:0435"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eqnsFixed", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"eqns", ",", 
      RowBox[{"{", 
       RowBox[{"c3", "==", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:0420\:0435\:0448\:0430\:0435\:043c", " ", 
    "\:0441\:0438\:0441\:0442\:0435\:043c\:0443", " ", "\:0434\:043b\:044f", 
    " ", 
    RowBox[{"{", 
     RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"solList", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"eqnsFixed", ",", "Cs", ",", "Reals"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"solList", "===", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<\:041e\:0448\:0438\:0431\:043a\:0430: Solve \:0432\:0435\:0440\
\:043d\:0443\:043b \:043f\:0443\:0441\:0442\:043e\:0439 \:0441\:043f\:0438\
\:0441\:043e\:043a \:0440\:0435\:0448\:0435\:043d\:0438\:0439. \:041f\:0440\
\:043e\:0432\:0435\:0440\:044c\:0442\:0435 \:0441\:0438\:043c\:0432\:043e\
\:043b\:044b.\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"First", "[", "solList", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"sol", "\[LongDash]", 
    RowBox[{
    "\:044d\:0442\:043e", " ", "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
     "\:043f\:0440\:0430\:0432\:0438\:043b", " ", "\:0432\:0438\:0434\:0430", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "->", "..."}], ",", 
       RowBox[{"c2", "->", "..."}], ",", "..."}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:0421\:043e\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
    "\:0440\:0430\:0437\:043d\:043e\:0441\:0442\:043d\:0443\:044e", " ", 
    "\:043a\:043e\:043c\:0431\:0438\:043d\:0430\:0446\:0438\:044e", " ", 
    "\:0443\:0437\:043b\:043e\:0432", " ", "\:043f\:043e\:0441\:043b\:0435", 
    " ", "\:043f\:043e\:0434\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0438"}\
], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeNode", "[", 
    RowBox[{"{", 
     RowBox[{"dx_", ",", "dt_"}], "}"}], "]"}], ":=", 
   RowBox[{"u", "[", 
    RowBox[{
     RowBox[{"i", "+", "dx"}], ",", 
     RowBox[{"j", "+", "dt"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"schemeLeft", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cs", ".", 
        RowBox[{"(", 
         RowBox[{"makeNode", "/@", "Sh"}], ")"}]}], ")"}], "/.", " ", "sol"}],
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:0414\:0438\:0441\:043a\:0440\:0435\:0442\:043d\:043e\:0435", " ", 
    RowBox[{"\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0435", ":", 
     RowBox[{"schemeLeft", "==", 
      RowBox[{"phi", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"schemeEq", "=", 
    RowBox[{"schemeLeft", "==", 
     RowBox[{"phi", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:0412\:044b\:0440\:0430\:0436\:0435\:043d\:0438\:0435", " ", 
    "\:0434\:043b\:044f", " ", 
    RowBox[{"u", "[", 
     RowBox[{"i", ",", 
      RowBox[{"j", "+", "1"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
     "\:0440\:0435\:0448\:0430\:0435\:043c", " ", 
      "\:043e\:0442\:043d\:043e\:0441\:0438\:0442\:0435\:043b\:044c\:043d\
\:043e", " ", "\:0441\:043b\:0435\:0434\:0443\:044e\:0449\:0435\:0433\:043e", 
      " ", "\:0441\:043b\:043e\:044f"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uNextSolve", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"schemeEq", ",", 
     RowBox[{"u", "[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "1"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"uNextSolve", "===", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<\:041d\:0435 \:0443\:0434\:0430\:043b\:043e\:0441\:044c \:0440\
\:0435\:0448\:0438\:0442\:044c \:0441\:0445\:0435\:043c\:0443 \:043e\:0442\
\:043d\:043e\:0441\:0438\:0442\:0435\:043b\:044c\:043d\:043e u[i,j+1].\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uNextExpr", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "1"}]}], "]"}], "/.", " ", 
      RowBox[{"First", "[", "uNextSolve", "]"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:041e\:0426\:0415\:041d\:041a\:0410", " ", 
    "\:041f\:041e\:0413\:0420\:0415\:0428\:041d\:041e\:0421\:0422\:0418"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TE", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "/.", " ", "sol"}], ")"}], "-", "Eq"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:0414\:043b\:044f", " ", 
    "\:0443\:0434\:043e\:0431\:0441\:0442\:0432\:0430", " ", 
    "\:0437\:0430\:043c\:0435\:043d\:0438\:043c", " ", 
    "\:044f\:0432\:043d\:044b\:0435", " ", 
    "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:0434\:043d\:044b\:0435", " ",
     "\:043d\:0430", " ", "\:043a\:0440\:0430\:0442\:043a\:0438\:0435", " ", 
    "\:0438\:043c\:0435\:043d\:0430"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TEclean", "=", 
    RowBox[{"TE", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "u0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "ut"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "ux"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "utt"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "3"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "uttt"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "uxt"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "uxtt"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"2", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "uxx"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"3", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
         RowBox[{"xi", ",", "tj"}], "]"}], "->", "uxxx"}]}], "}"}]}]}], ";"}],
   "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
      "\:041f\:0415\:0427\:0410\:0422\:042c", " ", 
       "\:041e\:0422\:0412\:0415\:0422\:041e\:0412"}], "===", "===", "==="}], 
     "="}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\:0412\:043e\:043f\:0440\:043e\:0441", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<\:0412\:043e\:043f\:0440\:043e\:0441:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Print", "[", 
    "\"\<\:041f\:043e\:0441\:0442\:0440\:043e\:0438\:0442\:044c \:0440\:0430\
\:0437\:043d\:043e\:0441\:0442\:043d\:043e\:0435 \:0443\:0440\:0430\:0432\
\:043d\:0435\:043d\:0438\:0435 \:043f\:043e \:0443\:043a\:0430\:0437\:0430\
\:043d\:043d\:043e\:043c\:0443 \
\:0448\:0430\:0431\:043b\:043e\:043d\:0443.\>\"", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<\:041e\:0442\:0432\:0435\:0442\>\"", "]"}], 
   ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "\:041f\:0435\:0447\:0430\:0442\:044c", " ", 
    "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f", " ", "\:0432", 
    " ", "\:0447\:0438\:0442\:0430\:0431\:0435\:043b\:044c\:043d\:043e\:0439",
     " ", "\:0444\:043e\:0440\:043c\:0435"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"schemeEq", "//", "TraditionalForm"}], ",", "InputForm"}], 
     "]"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:0414\:043e\:0431\:0430\:0432\:0438\:043c", " ", 
    "\:0442\:0430\:043a\:0436\:0435", " ", "\:044f\:0432\:043d\:043e\:0435", 
    " ", "\:0432\:044b\:0440\:0430\:0436\:0435\:043d\:0438\:0435", " ", 
    "\:0434\:043b\:044f", " ", 
    RowBox[{"u", "[", 
     RowBox[{"i", ",", 
      RowBox[{"j", "+", "1"}]}], "]"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"\:0412\:043e\:043f\:0440\:043e\:0441", " ", "2"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<\:0412\:043e\:043f\:0440\:043e\:0441:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Print", "[", 
    "\"\<\:041e\:0446\:0435\:043d\:0438\:0442\:044c \:043f\:043e\:0433\:0440\
\:0435\:0448\:043d\:043e\:0441\:0442\:044c \:0430\:043f\:043f\:0440\:043e\
\:043a\:0441\:0438\:043c\:0430\:0446\:0438\:0438 \:0434\:0438\:0444\:0444\
\:0435\:0440\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:043e\:0433\:043e\
 \:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f \:0432 \:0442\:043e\
\:0447\:043a\:0435 (x_m, t_n).\>\"", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<\:041e\:0442\:0432\:0435\:0442\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"TEclean", "//", "TraditionalForm"}], ",", "InputForm"}], "]"}],
     "]"}], ";"}], "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.972919598639347*^9, 3.972919598639347*^9}, {
   3.972919685847515*^9, 3.972919686314359*^9}, {3.9729197215099373`*^9, 
   3.972919789397252*^9}, {3.9729198227636113`*^9, 3.9729198699684877`*^9}, 
   3.9729199721919107`*^9, {3.972920048264123*^9, 3.97292005094969*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"e7c36697-b6ca-4cee-a499-bd4f83e93f7f"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\:0412\:043e\:043f\:0440\:043e\:0441:\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.972920052420371*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"3538fee7-4f9a-442a-abb1-c3c14088d170"],

Cell[BoxData["\<\"\:041f\:043e\:0441\:0442\:0440\:043e\:0438\:0442\:044c \
\:0440\:0430\:0437\:043d\:043e\:0441\:0442\:043d\:043e\:0435 \:0443\:0440\
\:0430\:0432\:043d\:0435\:043d\:0438\:0435 \:043f\:043e \:0443\:043a\:0430\
\:0437\:0430\:043d\:043d\:043e\:043c\:0443 \:0448\:0430\:0431\:043b\:043e\
\:043d\:0443.\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.9729200524263287`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"5648ca43-b6c2-4f1d-b510-3cc533d25afc"],

Cell[BoxData["\<\"\:041e\:0442\:0432\:0435\:0442\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.972920052430907*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"f1062377-3ab5-4f03-9fae-2108f8abf2f0"],

Cell[BoxData["\<\"\\!\\(\\*FormBox[RowBox[{FractionBox[RowBox[{RowBox[{\\\"-\\\
\", RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"a\\\", \\\" \\\", \
\\\"tauStep\\\"}], \\\"+\\\", \\\"hStep\\\"}], \\\")\\\"}], \\\" \\\", \
RowBox[{\\\"u\\\", \\\"(\\\", RowBox[{\\\"i\\\", \\\",\\\", \
RowBox[{\\\"j\\\", \\\"-\\\", \\\"1\\\"}]}], \\\")\\\"}]}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"hStep\\\", \\\"-\\\", \
RowBox[{\\\"a\\\", \\\" \\\", \\\"tauStep\\\"}]}], \\\")\\\"}], \\\" \\\", \
RowBox[{\\\"u\\\", \\\"(\\\", RowBox[{\\\"i\\\", \\\",\\\", \
RowBox[{\\\"j\\\", \\\"+\\\", \\\"1\\\"}]}], \\\")\\\"}]}], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"a\\\", \\\" \\\", \\\"tauStep\\\", \\\" \
\\\", RowBox[{\\\"u\\\", \\\"(\\\", RowBox[{RowBox[{\\\"i\\\", \\\"-\\\", \
\\\"1\\\"}], \\\",\\\", \\\"j\\\"}], \\\")\\\"}]}]}], RowBox[{\\\"2\\\", \\\" \
\\\", \\\"hStep\\\", \\\" \\\", \\\"tauStep\\\"}]], \\\"\[LongEqual]\\\", \
RowBox[{\\\"phi\\\", \\\"(\\\", RowBox[{\\\"i\\\", \\\",\\\", \\\"j\\\"}], \\\
\")\\\"}]}], TraditionalForm]\\)\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.9729200524326224`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"e619c6d7-1b04-449f-b5ef-1ad2c2064e9f"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.972920052435653*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"a8380eea-918d-449c-a3ff-29d2da5417ca"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.9729200524380493`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"ea9973c7-eca4-49f8-9be0-ef460b91a6b1"],

Cell[BoxData["\<\"\:0412\:043e\:043f\:0440\:043e\:0441:\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.9729200524402056`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"a44563ee-5e36-4ba8-aa45-6225a1fb475b"],

Cell[BoxData["\<\"\:041e\:0446\:0435\:043d\:0438\:0442\:044c \:043f\:043e\
\:0433\:0440\:0435\:0448\:043d\:043e\:0441\:0442\:044c \:0430\:043f\:043f\
\:0440\:043e\:043a\:0441\:0438\:043c\:0430\:0446\:0438\:0438 \:0434\:0438\
\:0444\:0444\:0435\:0440\:0435\:043d\:0446\:0438\:0430\:043b\:044c\:043d\:043e\
\:0433\:043e \:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f \:0432 \
\:0442\:043e\:0447\:043a\:0435 (x_m, t_n).\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.972920052442463*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"d04f7359-1cb2-4093-a3b1-672039509bc6"],

Cell[BoxData["\<\"\:041e\:0442\:0432\:0435\:0442\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.9729200524448223`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"2ec8e253-5e12-47e4-adf1-2056f8dc950f"],

Cell[BoxData["\<\"\\!\\(\\*FormBox[RowBox[{RowBox[{\\\"-\\\", \
RowBox[{RowBox[{FractionBox[\\\"1\\\", \\\"6\\\"]}], \\\" \\\", \\\"a\\\", \\\
\" \\\", SuperscriptBox[\\\"hStep\\\", \\\"2\\\"], \\\" \\\", \
\\\"uxxx\\\"}]}], \\\"-\\\", FractionBox[RowBox[{\\\"a\\\", \\\" \\\", \
SuperscriptBox[\\\"tauStep\\\", \\\"2\\\"], \\\" \\\", \\\"utt\\\"}], \
RowBox[{\\\"2\\\", \\\" \\\", \\\"hStep\\\"}]], \\\"+\\\", \
FractionBox[RowBox[{\\\"a\\\", \\\" \\\", \\\"hStep\\\", \\\" \\\", \\\"uxx\\\
\"}], \\\"2\\\"], \\\"+\\\", FractionBox[RowBox[{SuperscriptBox[\\\"tauStep\\\
\", \\\"2\\\"], \\\" \\\", \\\"uttt\\\"}], \\\"6\\\"]}], \
TraditionalForm]\\)\"\>"], "Print",
 CellChangeTimes->{3.9729196005994315`*^9, 3.9729196871882935`*^9, 
  3.9729197396776676`*^9, 3.972919828839534*^9, 3.9729198727070932`*^9, 
  3.9729199263439045`*^9, 3.972920052447941*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"40f9ec0f-3263-48cf-b974-9e95f4e1e818"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bd9e68ab-6a6b-4149-9d43-12c2704080e1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 20284, 567, 2246, "Input",ExpressionUUID->"e7c36697-b6ca-4cee-a499-bd4f83e93f7f"],
Cell[CellGroupData[{
Cell[20889, 593, 367, 6, 22, "Print",ExpressionUUID->"3538fee7-4f9a-442a-abb1-c3c14088d170"],
Cell[21259, 601, 628, 10, 22, "Print",ExpressionUUID->"5648ca43-b6c2-4f1d-b510-3cc533d25afc"],
Cell[21890, 613, 360, 6, 22, "Print",ExpressionUUID->"f1062377-3ab5-4f03-9fae-2108f8abf2f0"],
Cell[22253, 621, 1369, 20, 42, "Print",ExpressionUUID->"e619c6d7-1b04-449f-b5ef-1ad2c2064e9f"],
Cell[23625, 643, 330, 6, 22, "Print",ExpressionUUID->"a8380eea-918d-449c-a3ff-29d2da5417ca"],
Cell[23958, 651, 332, 6, 22, "Print",ExpressionUUID->"ea9973c7-eca4-49f8-9be0-ef460b91a6b1"],
Cell[24293, 659, 369, 6, 22, "Print",ExpressionUUID->"a44563ee-5e36-4ba8-aa45-6225a1fb475b"],
Cell[24665, 667, 736, 11, 22, "Print",ExpressionUUID->"d04f7359-1cb2-4093-a3b1-672039509bc6"],
Cell[25404, 680, 362, 6, 22, "Print",ExpressionUUID->"2ec8e253-5e12-47e4-adf1-2056f8dc950f"],
Cell[25769, 688, 961, 15, 43, "Print",ExpressionUUID->"40f9ec0f-3263-48cf-b974-9e95f4e1e818"]
}, Open  ]]
}, Open  ]]
}
]
*)

